# ============================================================================
# КОНФИГУРАЦИЯ MYPY - СТАТИЧЕСКАЯ ПРОВЕРКА ТИПОВ
# ============================================================================

[mypy]
# === БАЗОВЫЕ НАСТРОЙКИ ===
# Версия Python для проверки совместимости типов
python_version = 3.12
# Строгий режим - включает все самые строгие проверки типов
strict = true

# === ПРЕДУПРЕЖДЕНИЯ О ПРОБЛЕМАХ ТИПИЗАЦИИ ===
# Предупреждать о ненужных приведениях типов cast()
warn_redundant_casts = true
# Предупреждать о неиспользуемых # type: ignore комментариях
warn_unused_ignores = true
# Предупреждать при возврате Any типа из функций
warn_return_any = true
# Предупреждать о недостижимом коде после return/raise
warn_unreachable = true

# === НАСТРОЙКИ ВЫВОДА ===
# Показывать коды ошибок ([attr-defined], [no-untyped-def])
show_error_codes = true
# Показывать дополнительный контекст для ошибок
show_error_context = true
# Красивое форматирование вывода ошибок
pretty = true
# Цветной вывод ошибок в терминале
color_output = true

# === ПЛАГИНЫ ===
# Плагин для корректной работы с Pydantic моделями
plugins = pydantic.mypy

# === ИСКЛЮЧЕНИЯ ДЛЯ FASTAPI ===
# Разрешить декораторы без типов (нужно для @app.get() и т.д.)
disallow_untyped_decorators = false

# ============================================================================
# ПЕРЕОПРЕДЕЛЕНИЯ ДЛЯ КОНКРЕТНЫХ МОДУЛЕЙ
# ============================================================================

# === ВНЕШНИЕ БИБЛИОТЕКИ БЕЗ ТИПИЗАЦИИ ===
# Игнорировать отсутствующие типы для внешних библиотек

# Система миграций Alembic
[mypy-alembic.*]
ignore_missing_imports = true

# ORM SQLAlchemy (частично типизирована)
[mypy-sqlalchemy.*]
ignore_missing_imports = true

# Библиотека для хеширования паролей
[mypy-bcrypt.*]
ignore_missing_imports = true

# Библиотека python-jose для JWT
[mypy-jose.*]
ignore_missing_imports = true

# Библиотека для работы с паролями
[mypy-passlib.*]
ignore_missing_imports = true

# === МЕНЕЕ СТРОГИЕ ПРАВИЛА ДЛЯ ТЕСТОВ ===
# Тесты могут быть менее строго типизированы для удобства написания
[mypy-tests.*]
# Разрешить функции без аннотаций типов в тестах
disallow_untyped_defs = false
# Разрешить неполные определения типов в тестах
disallow_incomplete_defs = false
